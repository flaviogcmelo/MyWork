Para criar a trigger que desconecta sessões vindas de redes específicas e registra os detalhes da tentativa de conexão em uma tabela, você pode seguir os passos abaixo:

1. **Criar a tabela `tb_acesso_indevido`**:
   
   ```sql
   CREATE TABLE tb_acesso_indevido (
       id NUMBER GENERATED BY DEFAULT AS IDENTITY,
       hostname VARCHAR2(255),
       os_user VARCHAR2(255),
       ip VARCHAR2(255),
       login VARCHAR2(255),
       data_hora TIMESTAMP DEFAULT CURRENT_TIMESTAMP
   );
   ```

2. **Criar a trigger `disconnect_invalid_access`**:

   ```sql
   CREATE OR REPLACE TRIGGER disconnect_invalid_access
   AFTER LOGON ON DATABASE
   DECLARE
       v_ip VARCHAR2(255);
       v_os_user VARCHAR2(255);
       v_hostname VARCHAR2(255);
   BEGIN
       -- Obter o IP do cliente
       SELECT SYS_CONTEXT('USERENV', 'IP_ADDRESS') INTO v_ip FROM DUAL;

       -- Obter o usuário do SO
       SELECT SYS_CONTEXT('USERENV', 'OS_USER') INTO v_os_user FROM DUAL;

       -- Obter o hostname
       SELECT SYS_CONTEXT('USERENV', 'HOST') INTO v_hostname FROM DUAL;

       -- Verificar se o IP está nas redes bloqueadas
       IF v_ip LIKE '172.30.7.%' OR v_ip LIKE '172.30.6.%' OR v_ip LIKE '172.30.5.%' THEN
           -- Registrar a tentativa de conexão
           INSERT INTO tb_acesso_indevido (hostname, os_user, ip, login)
           VALUES (v_hostname, v_os_user, v_ip, SYS_CONTEXT('USERENV', 'SESSION_USER'));

           -- Desconectar a sessão
           RAISE_APPLICATION_ERROR(-20000, 'Conexão não permitida a partir deste IP.');
       END IF;
   END;
   ```

**Explicação:**

- **Tabela `tb_acesso_indevido`**: Esta tabela armazena detalhes sobre as tentativas de conexão não permitidas, incluindo o hostname, usuário do SO, IP, login e o timestamp da tentativa.

- **Trigger `disconnect_invalid_access`**: Esta trigger é acionada após o logon no banco de dados.
  - Utiliza `SYS_CONTEXT` para obter informações sobre a sessão, como o endereço IP (`IP_ADDRESS`), o usuário do sistema operacional (`OS_USER`) e o hostname (`HOST`).
  - Verifica se o IP está nas redes bloqueadas utilizando a cláusula `IF v_ip LIKE '172.30.7.%' OR v_ip LIKE '172.30.6.%' OR v_ip LIKE '172.30.5.%'`.
  - Se o IP estiver nas redes bloqueadas, insere um registro na tabela `tb_acesso_indevido` e desconecta a sessão utilizando `RAISE_APPLICATION_ERROR`.

Para aplicar essas mudanças, execute os scripts SQL no seu ambiente Oracle. Certifique-se de ter as permissões necessárias para criar tabelas e triggers no banco de dados.